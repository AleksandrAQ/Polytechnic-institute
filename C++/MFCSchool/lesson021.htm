<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0050)lesson021.htm -->
<HTML><HEAD><TITLE>Програмирование на Visual C++</TITLE>
</HEAD>
<BODY background="../bgrwhite.gif">
      <CENTER><B>Урок I</B></CENTER></FONT>
      <P>
      <P align=center><FONT color=black face=ARIAL size=4>Связывание элементов 
      управления</FONT></P>
 Сейчас мы свяжем элементы  управления с событиями. У нас всего два элемента - это две кнопки:      Say Hello и Exit. 
            <P>Теперь мы будем пользоваться еще одним мастером 
            <B>ClassWizard</B>, он сильно облегчит нам работу. Зайдите в 
            <B>VIEW-&gt;ClassWizard</B>, появится такая диалоговая панель 
            <P align=center><IMG src="lesson021.files/vc_clwizard_main.gif"></P>Рассмотрим эту панель. <BR>1) <B>Project</B>- здесь вы 
            выбираете свой проект.<BR>2) <B>ClassName</B> - название класса, 
            элементы которого вы будете связывать с событиями, проверьте, чтобы 
            там было установлено <B>CHelloDlg</B> - это класс, который связан с 
            главным диалоговым окном. <BR>3) <B>Object IDs</B> - это 
            итендификаторы(названия) элементов управления, в нашем случае это 
            две кнопки. Первый итендификатор - это название самого класса, оно 
            туда включено, так как с ним связаны многие события( это такие 
            значения, которые возращаются Windows, при совершении какого-нибудь 
            действия). <BR>4) <B>Messages</B> - а это как раз те самые события, 
            которые генерирует программа. К примеру, если вы нажали на кнопку, 
            то генерируется событие <B>BN_CLICKED</B>, а если два раза - то 
            <B>BN_DOUBLECLICKED.</B><BR>5) <B>Members function</B> - это список 
            функций, которые вы включили, и соответствующие им события. 
            <P>Теперь свяжем кнопку EXIT с событием <B>BN_CLICKED</B> - оно 
            возникает при нажатие на кнопку. Для этого щелкнем в <B>Object 
            IDs</B> на <B>IDC_EXIT_BUTTON</B>, справа появится события, с 
            которыми можно связать эту кнопку. Выбираем там <B>BN_CLICKED</B>. И 
            щелкаем на кнопке <B>Add Function </B>, которая находится справа. 
            Этим нажатием вы говорите Visual C++, что вам необходимо связать это 
            событие с функцией. Выведетя такая диалоговая панель, где вам 
            предложат выбрать название функции. Оставьте все по умолчанию и 
            нажмите кнопку <B>OK</B>. 
            <P align=center><IMG 
            src="lesson021.files/vc_clwizard_exit_funcname.gif"></P>В <B>Members 
            function</B> появилась запись о том, что мы связали кнопку (c 
            итендификатором <B>IDC_EXIT_BUTTON</B>) с функцией 
            <B>OnExitButton</B>. Теперь щелкаем по кнопке <B>Edit Code</B>, 
            которая находится ниже кнопки <B>Add Fucnction</B>. При нажатии на 
            эту кнопку мы переходим в режим редактирования исходного текста. В 
            окошке появится тест: 
            <P><B>void CHelloDlg::OnExitButton()<BR>{<BR>// TODO: Add your 
            control notification handler code 
            here<BR><BR>}<BR></B><BR>Коментарий <B>// TODO: Add your control 
            notification handler code here</B> говорит, что после него можно 
            ставлять свой код. <BR>Начало вашего кода будет обозначаться 
            <P><B>///Здесь начинается ваш код///</B> 
            <P>А конец вашего кода - 
            <P><B>///Здесь заканчивается ваш код///</B> 
            <P>Теперь введем код, для этого вам надо переписать его
            <P><B>void CHelloDlg::OnExitButton()<BR>{<BR>// TODO: Add your 
            control notification handler code here<BR><B>///Здесь начинается ваш 
            код///</B> 
            <P>OnOK();
            <P><B>///Здесь заканчивается ваш код///</B><BR>}<BR></B><BR>Вы 
            написали <B>OnOK();</B>, эта функция будет выполняться при каждом 
            нажатии на кнопку <B>EXIT</B>, и она предназначена для завершения 
            программы. Проверьте, чтобы в написании OnOK, OK было написано с 
            большой буквы, иначе, при компиляции программы, Visual C++ сообщит 
            вам об ошибке, так символы верхнего и нижнего регистра в VC имеют 
            распознаются по-разному. <BR>Итак вы связали кнопку <B>EXIT</B> с 
            событием <B>BN_CLICKED</B>, а его с функцией <B>OnExitButton</B>, 
            которая будет выполняться при каждом нажатии на кнопку <B>EXIT</B>. 
            <P>Теперь свяжем кнопку <B>Say Hello</B> с событием 
            <B>BN_CLICKED</B>. Для этого зайдем в меню 
            <B>VIEW-&gt;ClassWizard</B>.<BR>Выберем в <B>Object IDs</B> 
            <B>IDC_SAYHELLO_BUTTON</B><BR>Щелкнем на <B>BN_CLICKED</B> в 
            <B>Messages</B>( этим вы связываете кнопку <B>Say Hello</B> с 
            событием <B>BN_CLICKED</B>).<BR>Нажимаем на <B>Add function</B>, 
            этим вы связываете событие <B>BN_CLICKED</B> с функцией.<BR>В 
            раскрывшемся окне оставляем все по умолчанию и нажимаем кнопку 
            <B>OK</B>. <BR>
            <P align=center><IMG 
            src="lesson021.files/vc_clwizard_sayhello_func.gif"></P>Затем нажимаем на кнопку <B>Edit Code</B>, для 
            редактирование исходного текста.<BR>И в раскрывшемся окне пишем 
            следующий код: 
            <P><B>void CHelloDlg::OnSayhelloButton() <BR>{<BR>// TODO: Add your 
            control notification handler code here<BR><B>///Здесь начинается ваш 
            код///</B> 
            <P>MessageBox("Say Hello");
            <P><B>///Здесь заканчивается ваш код///</B><BR>}<BR></B>Функция 
            <B>MessageBox("Say Hello");</B> вызывает окно сообщений, в котором 
            написан текст <B>Say Hello</B>, который и является параметром этой 
            функции.<BR>Итак, вы связали кнопки <B>Say Hello</B> и <B>EXIT</B> с 
            событием <B>BN_CLICKED</B>. При нажатии на кнопку <B>Exit</B> 
            программа завершается, а при нажатии на кнопку <B>Say Hello</B> 
            выводится сообщение <B>"Say Hello"</B>. <BR>Теперь вам осталось 
            построить и выполнить программу. Нажимаем Далее... 
       <div align="center">     <BR><BR>Компиляция и запуск программы <br><A 
            href="lesson011.htm"><B 
            class=base2>&lt;-Назад</B></A> || <A 
            href="lesson031.htm"><B 
            class=base2>Дальше -&gt;</B></A> </div>
      </P></FONT>
<p><div align="center"><a href="lesson.htm"><img src="../soder.gif" width=120 height=31 border=0 alt=""></a></div></p>			  
	  </BODY></HTML>
